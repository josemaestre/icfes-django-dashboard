{% extends 'base.html' %}

{% load static i18n crispy_forms_tags %}

{% block title %}Sign Up{% endblock title %}

{% block body_attribute %}class="authentication-bg"{% endblock body_attribute %}

{% block content %}
<div class="account-pages pt-2 pt-sm-5 pb-4 pb-sm-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-xl-12">
                <div class="card auth-card">
                    <div class="card-body p-0">
                        <div class="row align-items-center g-0">
                            <div class="col-lg-6 d-none d-lg-inline-block border-end">
                                <div class="auth-page-sidebar">
                                    <img src="{% static '/images/sign-in.svg' %}" alt="auth" class="img-fluid" />
                                </div>
                            </div>
                            <!-- end col -->

                            <div class="col-lg-6">
                                <div class="p-4">
                                    <div class="mx-auto mb-4 text-center auth-logo">
                                        <a href="/" class="logo-dark">
                                            <img src="{% static '/images/logo-sm.png' %}" height="30" class="me-1"
                                                alt="logo sm" />
                                            <img src="{% static '/images/logo-dark.png' %}" height="24"
                                                alt="logo dark" />
                                        </a>

                                        <a href="/" class="logo-light">
                                            <img src="{% static '/images/logo-sm.png' %}" height="30" class="me-1"
                                                alt="logo sm" />
                                            <img src="{% static '/images/logo-light.png' %}" height="24"
                                                alt="logo light" />
                                        </a>
                                    </div>

                                    <h2 class="fw-bold text-center fs-18">
                                        Sign Up
                                    </h2>
                                    <p class="text-muted text-center mt-1 mb-4">
                                        New to our platform? Sign up
                                        now! It only takes a minute.
                                    </p>

                                    <div class="row justify-content-center">
                                        <div class="col-12 col-md-8">
                                            <form id="signup_form" method="post" action="{% url 'account_signup' %}"
                                                class="authentication-form">

                                                {% csrf_token %}
                                                {{ form|crispy }}
                                                {% if redirect_field_value %}
                                                <input type="hidden" name="{{ redirect_field_name }}"
                                                    value="{{ redirect_field_value }}" />
                                                {% endif %}

                                                <div class="mb-1 text-center d-grid">
                                                    <button class="btn btn-primary" type="submit">
                                                        Sign Up
                                                    </button>
                                                </div>
                                            </form>
                                            <p class="mt-3 fw-semibold no-span">
                                                OR sign with
                                            </p>

                                            <div class="text-center">
                                                <a href="javascript:void(0);" class="btn btn-light shadow-none"><i
                                                        class="bx bxl-google fs-20"></i></a>
                                                <a href="javascript:void(0);" class="btn btn-light shadow-none"><i
                                                        class="bx bxl-facebook fs-20"></i></a>
                                                <a href="javascript:void(0);" class="btn btn-light shadow-none"><i
                                                        class="bx bxl-github fs-20"></i></a>
                                            </div>
                                        </div>
                                        <!-- end col -->
                                    </div>
                                    <!-- end row -->
                                </div>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->
                    </div>
                    <!-- end card-body -->
                </div>
                <!-- end card -->

                <p class="text-white mb-0 text-center">
                    I already have an account
                    <a href="{% url 'account_login' %}" class="text-white fw-bold ms-1">Sign In</a>
                </p>
            </div>
            <!-- end col -->
        </div>
        <!-- end row -->
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const userTypeSelect = document.getElementById('id_user_type');
        const organizationField = document.getElementById('div_id_organization_name');

        // B2B user types that should show organization field
        const b2bTypes = ['principal', 'government', 'researcher', 'preicfes', 'language_academy', 'consultant'];

        function toggleOrganizationField() {
            if (userTypeSelect && organizationField) {
                const selectedType = userTypeSelect.value;
                if (b2bTypes.includes(selectedType)) {
                    organizationField.style.display = 'block';
                } else {
                    organizationField.style.display = 'none';
                }
            }
        }

        // Initial state
        if (organizationField) {
            organizationField.style.display = 'none';
        }

        // Listen for changes
        if (userTypeSelect) {
            userTypeSelect.addEventListener('change', toggleOrganizationField);
        }
    });
</script>
{% endblock content %}